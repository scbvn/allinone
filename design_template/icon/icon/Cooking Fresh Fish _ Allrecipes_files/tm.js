!function(){var p=2,g=4,w=5,m=6,k=7;var T=function(e){-1!==e.indexOf("http://")?e=e.substring(7,e.length):-1!==e.indexOf("https://")?e=e.substring(8,e.length):"//"===e.substring(0,2)&&(e=e.substring(2,e.length));var t=e.indexOf("/");-1<t&&(e=e.substring(0,t));var n=e.split(".");return-1<e.indexOf(".co.uk")?2<n.length?n[n.length-3]+"."+n[n.length-2]+"."+n[n.length-1]:n[0]:1<n.length?n[n.length-2]+"."+n[n.length-1]:n[0]};function C(o,i,e){if(!(this instanceof C))return new C(o,i,e);for(var t={},n=o.cookie.split(";"),r=0;r<n.length;r++){var a=n[r].split("=");2===a.length&&(t[a[0].trim()]=a[1].trim())}var s=function(t,n,o){o||(o=e),this.toString=function(){var e=t+"="+encodeURIComponent(n)+";";return e+="expires="+new Date(o).toGMTString()+";",e+="path=/;",e+="domain=."+i+";"}};this.removeCookie=function(e){var t=new s(e,"",(new Date).getTime()-1e4);o.cookie=t.toString()},this.setCookie=function(e,t){var n=new s(e,t);o.cookie=n.toString()},this.getCookieValue=function(e){return t[e]},this.hasCookie=function(e){return e in t}}function i(e,t,n){var o=window._viantTML;if(0===o.length)return o.push(1),void e(t,n);window.setTimeout(function(){i(function(){e(t,n)})},100)}function t(e){var t=window._viantTMQ;if(t&&t.length)for(var n=t.length,o=0;o<n;o++){var i=t.shift();i&&i(e)}}function y(f){if(!(this instanceof y))return new y(f);var e="_viantTMC";if(e in window)return t(window[e]),window[e];var l=this;function r(e){var t=f.createElement("script");t.async=!0,t.type="text/javascript",t.src=e;var n=f.querySelector("script");return n.parentNode.insertBefore(t,n),t}var a=[],s=[];function o(e){if(!0==("SCRIPT"===e.tagName.toUpperCase()))e.parentNode.replaceChild(function(e){var t=f.createElement("script");e.innerHTML&&(t.text=e.innerHTML);for(var n=e.attributes.length-1;0<=n;n--)t.setAttribute(e.attributes[n].name,e.attributes[n].value);return t}(e),e);else for(var t=0;t<e.childNodes.length;t++)o(e.childNodes[t]);return e}return this.runPending=function(){t(l)},this.handleDocumentWrite=function(e){var t;if(e.parentId){var n=f.querySelector("#"+e.parentId);n&&(t=f.write,"write"in window||(window.write=t),f.write=function(e){"&nbsp;"==n.innerHTML&&(n.innerHTML="");var t=f.createElement("div");(t.innerHTML=e,t.firstChild)&&o(n.appendChild(t.firstChild))})}return t},this.exec=function(n){for(var e=a.length,t=0;t<e;t++){s.shift();var o=a.shift();o&&"function"==typeof o.callback&&i(function(e,t){try{l.handleDocumentWrite(e.context);e.context.onReady=function(e){window._viantTML.shift(),t&&t.parentNode&&t.parentNode.removeChild(t)},e.callback(n,e.context)}catch(e){console.log("Failed to run callback"+e)}},o)}},this.asyncExec=function(e,t,n,o){n||(n="//ucid.vindicosuite.com/s.js"),n.endsWith("p.js")&&(n=n.replace("p.js","s.js")),a.push({callback:e,context:t});var i=r(n);s.push(i),o&&window.setTimeout(function(){new y(f).exec({})},o)},this.expandVariables=function(e,t){if(!e)return e;if("string"!=typeof e)return e;for(var n in t)for(var o="["+n+"]",i=0;i<e.length;i++){var r=e.indexOf(o);if(-1===r)break;var a=e.substring(0,r),s=e.substring(r+o.length,e.length);e=a+t[n]+s}return e},this.inView=function(e){for(var t=e.offsetTop,n=e.offsetLeft,o=e.offsetWidth,i=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+i>window.pageYOffset&&n+o>window.pageXOffset?1:0},this.getEnv=function(e){var t={r:encodeURIComponent(f.referrer),u:encodeURIComponent(f.URL||f.location.href||window.location.href),ts:(new Date).getTime(),iv:""},n=f.location.ancestorOrigins;return window!==top&&n&&0<n.length&&(t.u=encodeURIComponent(n[n.length-1])),t.dsd=T(t.u),e&&(t.iv=l.inView(e)),t},this.loadElement=function(s,c,e){var d;c.parentId&&(d=f.querySelector("#"+c.parentId));var u=l.getEnv(d);l.asyncExec(function(e,t){for(var n in u)e[n]=u[n];for(var o in c)c[o]=l.expandVariables(c[o],e);var i=f.createElement(s);for(var r in t.onReady&&(i.onreadystatechange=i.onload=t.onReady),c)i.setAttribute(r,c[r]);if(!d){var a=f.querySelectorAll("script");d=a[a.length-1]}d.parentNode.insertBefore(i,d)},c,args.tokenServer+"/s.js",e)},this.getParentId=function(){(e=f.createElement("span")).setAttribute("style","padding:0;margin:0"),e.id="vtm"+(new Date).getTime()+"_"+parseInt(1e4*Math.random());try{var e;if(f.write(e.outerHTML),(e=f.querySelector("#"+e.id))&&e.id)return e.innerHTML="&nbsp;",e.id}catch(e){}return null},this.loadScript=function(e,t){e.parentId||(e.parentId=l.getParentId()),e.type="text/javascript",e.sync=!0,l.loadElement("script",e,t)},this.loadIFrame=function(e,t){e.parentId||(e.parentId=l.getParentId());var n={border:"0",frameborder:"0",marginwidth:"0",marginheight:"0",hspace:"0",vspace:"0",scrolling:"NO",style:"margin:0;padding:0"};for(var o in n)o in e||(e[o]=n[o]);l.loadElement("iframe",e,t)},this.dropJsPixel=function(e,t){t||(t=2e3);var n=l.getEnv(),o=r(e=l.expandVariables(e,n));window.setTimeout(function(){o&&o.parentNode&&o.parentNode.removeChild(o)},t)},window[e]=this,t(l),this}window._viantTML||(window._viantTML=[]),window._viantTMQ||(window._viantTMQ=[]),new function(r){try{var a=this,o=r.tokenName,i=r.tokenSyncName;a.referer=r.document.referrer,a.currentPageUrl=r.document.URL||r.document.location.href||window.location.href;var e=r.document.location.ancestorOrigins;window!==top&&e&&0<e.length&&(a.currentPageUrl=e[e.length-1]),a.tokenValue="";var t=0;r.sessionEventInterval&&(t=1e3*Number(r.sessionEventInterval));var n=r.activityEvents||["keypress","mousemove","touchstart"],s=(new Date).getTime(),c=T(r.document.location.hostname||a.currentPageUrl),d=1e3*Number(r.syncIntervalInSec),u=60*Number(r.expiryInDays)*60*24*1e3,f=new C(r.document,c,(new Date).getTime()+u),l=y(r.document),v=s,h=0;this.setTokenValueFromCookie=function(){f.hasCookie(o)&&(a.tokenValue=f.getCookieValue(o))},this.setToken=function(e){return 0<e.length&&(a.tokenValue=e,f.setCookie(i,(new Date).toGMTString()),f.setCookie(o,e),!0)},this.isTokenSynchronizationNeeded=function(){if(!f.hasCookie(o)||!f.hasCookie(i))return!0;var e=decodeURIComponent(f.getCookieValue(i));if(""===e)return f.setCookie(i,(new Date).toGMTString()),!0;try{var t=Date.parse(e),n=(new Date).getTime()-t;return d<n}catch(e){return f.setCookie(i,(new Date).toGMTString()),!0}},this.injectClickEvents=function(){for(var e=document.querySelectorAll("a"),t=0;t<e.length;t++)e[t].getAttribute("href")&&e[t].addEventListener("click",function(e){var t=e.target||e.srcElement;return t.getAttribute("href")&&a.dropClickEvent(t),!0},!0)},this.dropEvent=function(e,t){t.r=encodeURIComponent(a.referer),t.u=encodeURIComponent(a.currentPageUrl),t.t=a.tokenValue,t.s=h,r.sid&&(t.sid=encodeURIComponent(r.sid)),r.cd&&(t.cd=encodeURIComponent(r.cd)),document.cookie&&(t.cc=encodeURIComponent(document.cookie)),t.p=(new Date).getTime()-s;for(var n=Object.keys(t).sort(),o=r.tokenServer+"/e/?i="+e,i=0;i<n.length;i++)"i"!==n[i]&&(o+="&"+n[i]+"="+t[n[i]]);l.dropJsPixel(o)},this.dropLoadedEvent=function(){a.dropEvent(w,{})},this.dropTokenEvent=function(){a.dropEvent(p,{})},this.dropAliveEvent=function(){a.dropEvent(m,{})},this.dropUnloadEvent=function(){a.dropEvent(k,{})},this.dropClickEvent=function(e){try{var t=e.getAttribute("href"),n=function(e){for(var t=0;t<5;t++){if(!e||void 0===e)return"";var n=e.getAttribute("id");if(n)return n;e=e.parentElement}return""}(e);a.dropEvent(g,{d:n,l:encodeURIComponent(t)})}catch(e){console.log("Failed to drop event "+g)}},this.setActivityTime=function(){return v=(new Date).getTime(),!0},this.initSession=function(){for(var e=0;e<n.length;e++)document.addEventListener(n[e],a.setActivityTime);window.setInterval(a.manageSession,3e4)},this.initUnload=function(){var e=window.onbeforeunload;e||(e=window.unload),window.unload=window.onbeforeunload=function(){a.dropUnloadEvent(),e&&e()}},this.onLoad=function(){a.dropLoadedEvent(),window.setTimeout(a.injectClickEvents,1e3),a.initSession(),a.initUnload()},this.manageSession=function(){(new Date).getTime()-v<33e3&&(h+=3e4,t&&t<=h&&(a.dropAliveEvent(),t*=2))},this.syncTokenIfNeeded=function(){a.isTokenSynchronizationNeeded()?l.asyncExec(function(e){var t=e.t;t?(a.setToken(t),a.dropTokenEvent()):(f.removeCookie(r.tokenSyncName),f.removeCookie(o)),a.onLoad()},{},r.tokenServer+"/s.js"):a.onLoad()},a.setTokenValueFromCookie(),a.syncTokenIfNeeded()}catch(e){console.log("Failed to instantiate TokenManager due to "+e)}}(_viantTMInit)}();